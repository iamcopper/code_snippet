#CROSS_COMPILE ?= aarch64-linux-gnu-
CC := gcc
ODIR := .build

CFLAGS := -Wall -g \
		 -Werror

EXTRAINCDIRS +=

CFLAGS += $(patsubst %,-I %,$(EXTRAINCDIRS))
CFLAGS += -MD -MP -MF .dep/$(@F).d

LFLAGS :=

OUT := $(patsubst %.c,%,$(wildcard *.c))

all: $(OUT)

$(OUT): %: $(addprefix $(ODIR)/,%.o)
	$(CROSS_COMPILE)$(CC) $(CFLAGS) -o $@ $^

$(ODIR)/%.o: %.c
	@echo ">>> $<"
	@mkdir -p $(@D)
	$(CROSS_COMPILE)$(CC) $(CFLAGS) -c $< -o $@

include $(shell mkdir .dep 2>/dev/null) $(wildcard .dep/*)

clean:
	$(RM) -r .dep $(ODIR) $(OUT)

.PHONY: all clean
